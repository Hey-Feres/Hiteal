- provide :head_tags do
	meta name='turbolinks-visit-control' content='reload'

= render './ui/components/sidebar', dados: @sidebar_items

- if @gym.nil?
	= render './ui/components/introduction-box', dados: @introduction_box_dados
.content
	// ________________________________________________________________________________
	.divider.dados-gym#wrapperDados
		.divider-header
			h3 Dados Gym
		.divider-content
			form
				.d-flex.justify-content-start
					= render './ui/components/text-field', input: @inputs_attributes[:gym_nome]
				br
				.d-flex.justify-content-start
					= render './ui/components/text-field', input: @inputs_attributes[:gym_razao_social]
				br
				.d-flex.justify-content-start
					= render './ui/components/text-field', input: @inputs_attributes[:gym_cnpj]
	// ________________________________________________________________________________
	.divider.endereco-gym#wrapperEndereco
		.divider-header
			h3 Endere√ßo
		.divider-content
			form
				.d-flex.justify-content-start
					= render './ui/components/text-field', input: @inputs_attributes[:gym_cep]
				br
				.d-flex.justify-content-start
					= render './ui/components/text-field', input: @inputs_attributes[:gym_rua]
				br					
				.d-flex.justify-content-start
					= render './ui/components/text-field', input: @inputs_attributes[:gym_cidade]
				br
				.d-flex.justify-content-start
					= render './ui/components/text-field', input: @inputs_attributes[:gym_estado]
				br
				.d-flex.justify-content-start
					= render './ui/components/text-field', input: @inputs_attributes[:gym_numero]
				br			
				.d-flex.justify-content-start
					= render './ui/components/text-field', input: @inputs_attributes[:gym_lat]
				br
				.d-flex.justify-content-start
					= render './ui/components/text-field', input: @inputs_attributes[:gym_lng]
			br
			#map
	// ________________________________________________________________________________
	.divider.imagens-gym#wrapperImagens
		.divider-header.d-flex.justify-content-between
			h3 Imagens
			= render './ui/icons/plus', size: 40, color: "3498DB"
		.divider-content
			///form
				/input#upload type='file' multiple="true" direct_upload="true"
			= form_with(url: "/api/v1/gyms/1", method: "PUT") do |f|
				= f.file_field :imagens, multiple: true, direct_upload: true, id: "imagens-field"
			br
			br
			img id="myImg" src="#" alt="your image" height="200" width="100"

javascript:
	/*window.addEventListener('load', function() {
		document.querySelector('input[type="file"]').addEventListener('change', function() {
			if (this.files && this.files[0]) {
				//var img = $("myImg"[0]);  // $('img')[0]
				var imgField = $("#imagens-field").val();
	          	
	          	//img.src = URL.createObjectURL(this.files[0]); // set src to blob url
	          	console.log("**************")
	          	console.log(imgField)
	          	//img.onload = imageIsLoaded;

		        let request = new Request();
		        let data = { "gym": {"imagens": imgField} }
		        let url = apiBaseUrl + "/gyms/#{@gym.id}"
		        let headers = {}
		        let successCallback = function(data){ 
		            console.log(data);
		        }
		        // .  .  .  .  .  .  .  .  .  .  .  .
		        let errorCallback = function(jqXHR, textStatus, msg){ 
		            console.log(msg);
		        }
		        // .  .  .  .  .  .  .  .  .  .  .  .
		        const response = request.put(data, url, successCallback , errorCallback, headers)
	      	}
	  	});
	});

	function imageIsLoaded() { 
	  alert(this.src);  // blob url
	  // update width and height ...
	}*/
css:
	#map {
	    width: 100%;
	    height: 600px;
	    border-top-left-radius: 20px;
	    border-top-right-radius: 20px;
	}
	.divider{
		background: #fff;
		padding: 1 2%;
		border-radius: 20px;
	}
	.divider-header{
		padding: 3%;
	}
	.divider-content{
		padding: 0 3%;	
	}
	.divider-content h5{
		margin-bottom: 5%;
	}
	.content{
		width: 76%;
		position: absolute;
		height: 100%;
		left: 22%;
		right: 2%;
		z-index: 9;
		/*background: #555;*/
		margin-top: 10px;
		padding: 0;
	}
	.dados-gym, .endereco-gym, .imagens-gym{
		position: absolute;
		height: 90%;
		width: 100%;
		overflow: scroll;
	}

javascript:
    $(document).ready(function(){
    	let user = new User("#{current_user.nome}","#{current_user.gym_id}")
    	user.getLocation();
    	
		// Inicializa a classe gym
		let gym = new Gym("#{@gym.nome}", "#{@gym.cnpj}", "#{@gym.razao_social}", "#{@gym.id}", "#{Rails.application.credentials.cep_api_key}", "#{Rails.application.credentials.cep_api_secret}");
		// Inicializa os estados das divs
		gym.componentLoaded()
		// Inicializa o mapa
		gym.initMap(-19.984441834617307,-43.8485310499241);
		// Swicth dos estados das divs
		$("#dados-toggler").click(function(event) 	 { 	gym.toggleWrappers(event, "#wrapperDados")	  })
		$("#endereco-toggler").click(function(event) { 	gym.toggleWrappers(event, "#wrapperEndereco") })
		$("#imagens-toggler").click(function(event)  { 	gym.toggleWrappers(event, "#wrapperImagens")  })
		// Input com nome
		$("#gym-nome").change(function() {
			response = gym.mudarNome($("#gym-nome").val())
			console.log(response)
		})
		// Input com CNPJ
		$("#cnpj").change(function() {
			response = gym.mudarCnpj($("#cnpj").val())
			console.log(response)
		})
		// Input com Razao Social
		$("#razao-social").change(function() {
			response = gym.mudarRazaoSocial($("#razao-social").val())
			console.log(response)
		})
		// Input com CEP
		$("#cep").change(function() {
			response = gym.mudarCep($("#cep").val())
			console.log(response)
		})
		// Input com Rua
		$("#rua").change(function() {
			response = gym.mudarRua($("#rua").val())
			console.log(response)
		})		
		// Input com Cidade
		$("#cidade").change(function() {
			response = gym.mudarCidade($("#cidade").val())
			console.log(response)
		})
		// Input com Estado
		$("#estado").change(function() {
			response = gym.mudarEstado($("#estado").val())
			console.log(response)
		})
		// Input com Numero
		$("#numero").change(function() {
			response = gym.mudarNumero($("#numero").val())
			console.log(response)
		})
		// Input com Latitude
		$("#latitude").change(function() {
			response = gym.mudarLatitude($("#latitude").val())
			console.log(response)
		})
		// Input com Longitude
		$("#longitude").change(function() {
			response = gym.mudarLongitude($("#longitude").val())
			console.log(response)
		})

    })
